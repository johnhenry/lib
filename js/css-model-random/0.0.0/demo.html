<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>CSS Model Random</title>
    <style>
      * {
        padding: 0px;
        margin: 0px;
      }
      html {
        height: 100%;
      }
      body {
        position: relative;
        height: 100%;
      }
      section {
        padding: 32px;
        border-bottom-right-radius: 16px;
        background-color: #ffffffdd;
        position: fixed;
        z-index: 1;
      }
      .rectangle {
        position: absolute;
        display: block;
        transition: width var(--speed) var(--transition-function),
          height var(--speed) var(--transition-function),
          left var(--speed) var(--transition-function),
          top var(--speed) var(--transition-function);
      }
    </style>
    <script
      type="module"
      src="../../../js/css-model-gamepad/0.0.0/global.mjs"
    ></script>
    <script type="module">
      import CSSModelRandom from "./index.mjs";
      import textToDOMNodes from "../../text-to-DOM-nodes/0.0.0/index.mjs";
      const count = 64;
      const varCount = count * 4;
      const width = "25%";
      const height = "25%";
      const seconds = 5;

      for (let i = 0; i < count; i++) {
        const a = 4 * i;
        const b = a + 1;
        const c = b + 1;
        const d = c + 1;
        // const color = `#${Math.floor(Math.random() * 2 ** 32)
        //   .toString(16)
        //   .padStart(8, "0")}`;
        const color = `#${Math.floor(Math.random() * 2 ** 16)
          .toString(16)
          .padStart(4, "0")}`;
        // const color = `rgba(${Math.floor(Math.random() * 256)}, ${Math.floor(
        //   Math.random() * 256
        // )}, ${Math.floor(Math.random() * 256)}, ${Math.random()})`;

        document.body.prepend(
          ...textToDOMNodes(`
                <div
        class="rectangle"
        data-id="${i}"
        style="
          background-color: ${color};
          --transition-function: ease-in-out;
          --speed: ${seconds}s;
          transform: skew(calc(var(--gamepad-axis-0, 0) * 0.1turn), calc(var(--gamepad-axis-1, 0)  * 0.1turn)) scale(calc(var(--gamepad-axis-2,0) + 0.5), calc(var(--gamepad-axis-3, 0) + 0.5 ));
          width: calc(${width} * var(--rand-${a}, 1));
          height: calc(${height} * var(--rand-${b}, 1));
          left: calc((100vw - (${width} * var(--rand-${a},1))) * var(--rand-${c}, 0.5));
          top: calc((100vh - (${width} * var(--rand-${b},1))) * var(--rand-${d}, 0.5));
        "
      ></div>`)
        );
      }

      setTimeout(() => {
        const model = new CSSModelRandom(
          globalThis.document.documentElement,
          undefined,
          {
            count: varCount,
          }
        );
        const interval = setInterval(() => {
          model.reset();
        }, seconds * 1000);
        globalThis.document.onclick = () => {
          clearInterval(interval);
          model.reset();
        };
      });
    </script>
  </head>
  <body>
    <section>
      <h1>CSS Model: Random</h1>
    </section>
  </body>
</html>
