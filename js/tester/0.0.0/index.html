<p>import { Meta } from “<span class="citation" data-cites="storybook/addon-docs/blocks">@storybook/addon-docs/blocks</span>”;</p>
<Meta title="JS Library/Tester/Docs" />
<h1 id="tester">Tester</h1>
<p>../js/tester@latest/index.mjs</p>
<p>Tester is a javascript testing framework based on <a href="https://github.com/substack/tape">Tape</a>.</p>
<p>Like Tape, tester</p>
<ul>
<li>can be run directly using <a href="https://nodejs.org">node</a> without any additional binaries or transformations.</li>
<li>produces output using the standard <a href="https://testanything.org/">Test Anything Protocol</a>.</li>
</ul>
<p>Unlike Tape, tester</p>
<ul>
<li>can be run directly in the browser or using <a href="https://deno.land">deno</a> without any additional binaries/transformations, along with node.</li>
<li>uses external assertions and makes it easy to write your own.</li>
</ul>
<h2 id="api">API</h2>
<p>Tester’s API consist of two manin components:</p>
<ul>
<li>The “tester” function acts on a group of assertions.</li>
<li>The assertions themselves, which return errors if a given condition is not satisfied.</li>
</ul>
<h3 id="tester-1">Tester</h3>
<p>The tester function is the default export.</p>
<p>It takes as its only argument a [possibly asynchronous] generator. We call this a “test”.</p>
<p>Results of assertions are yielded from within the body of a test.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tester <span class="im">from</span> <span class="st">&quot;./index.mjs&quot;</span><span class="op">;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tester</span>(<span class="kw">function</span><span class="op">*</span> () {</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">yield</span> <span class="co">/*some assertion result*/</span><span class="op">;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">yield</span> <span class="co">/*some other assertion result*/</span><span class="op">;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
<h3 id="assertions">Assertions</h3>
<p>The named exports are assertions.</p>
<p>Call them within a test and yield their results.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tester<span class="op">,</span> { ok<span class="op">,</span> notok } <span class="im">from</span> <span class="st">&quot;./index.mjs&quot;</span><span class="op">;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tester</span>(<span class="kw">function</span><span class="op">*</span> () {</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">yield</span> <span class="fu">ok</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">yield</span> <span class="fu">notok</span>(<span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
<h4 id="included-assertions">Included Assertions</h4>
<p>Besides ok and notok, there are a number of assertions included:</p>
<ul>
<li>ok – test passes if and only if the given argument to a test is TRUTHY.</li>
<li>notok – test passes if and only if the given argument to a test is FALSH.</li>
<li>equal – test passes if and only if the two given arguments are THE SAME object.</li>
<li>notequal – test passes if and only if the two given arguments are NOT THE SAME object.</li>
<li>pass – test ALWAYS PASSES</li>
<li>fail – test ALWAYS FAILS</li>
<li>subtestpass – test passes if and only if the given argument is a test in which ALL THE ASSERTIONS PASS.</li>
<li>subtestfail – test passes if and only if the given argument is a test in which AT LEAST ONE ASSERTION FAILS.</li>
<li>throws – test passes if and only if the given function THROWS AN ERROR when called</li>
<li>doesnotthrow – test passes if and only if the given function DOES NOT THROW AN ERROR when called</li>
</ul>
<h3 id="plan">plan</h3>
<p>When using the run function, the first argument passed to given generator is a function. We’ll call it “plan”, but you can name it anyting you like (“expect”, “assertions”, etc.) When <em>plan</em> is called with an integer, it dictates the number of expected assertions in a given test function.</p>
<p>import tester, { ok } from “./index.mjs”;</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tester</span>(<span class="kw">function</span><span class="op">*</span> (plan) {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plan</span>(<span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">yield</span> <span class="fu">ok</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
<h2 id="creating-assertions">Creating Assertions</h2>
<p>When creating assertions, use the examples in <em>./assertions</em> for inspiration. Here are a few things to keep in mind:</p>
<ul>
<li>Assertions are functions that test for a desired conditon.</li>
<li>If the given conditions meet the desired conditions,
<ul>
<li>an accepted message is returned.</li>
<li>Otherwise, an instance of TestError is returned.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> TestError <span class="im">from</span> <span class="st">&quot;./testerror.mjs&quot;</span><span class="op">;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> assertion <span class="op">=</span> (<span class="co">/*given conditions*/</span>)<span class="kw">=&gt;</span>{</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="co">/*conditions are met*/</span>){</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="co">/*some message*/</span><span class="op">;</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">new</span> <span class="fu">TestError</span>(<span class="co">/*some message*/</span>)<span class="op">;</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h3 id="conventions">Conventions</h3>
<p>This library follows a specific convetion for its assertions. It’s recommended that you follow these conventions when creating your own assertions, but feel free to come up with your own.</p>
<ul>
<li>The last item is an <em>operator string</em>, which is used for the TAP protocol and can be overridden.</li>
<li>The next-to-last item is a <em>default expected message</em> that can also be overridden.</li>
<li>The preceeding arguments are given conditions to be tested.</li>
<li>The returned TestError is constructed using the default expected message along with an object detailing the difference between what’s expected and what’s not.</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> TestError <span class="im">from</span> <span class="st">&quot;./testerror.mjs&quot;</span><span class="op">;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> assertion <span class="op">=</span> (<span class="co">/*given conditions*/</span><span class="op">,</span> message<span class="op">,</span> operatorString)<span class="kw">=&gt;</span>{</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="co">/*conditions are met*/</span>){</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> message<span class="op">;</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">new</span> <span class="fu">TestError</span>(message<span class="op">,</span> <span class="co">/*some object*/</span>))<span class="op">;</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h3 id="testerror-api">TestError API</h3>
<p>The test error is constructed with two items:</p>
<ul>
<li>An expected messages</li>
<li>An object who’s key-value pairs are displayed as part of TAP output</li>
</ul>
<h1 id="tester-2">Tester</h1>
<p>A context-independent testing framework inspired by <a href="https://github.com/substack/tape">tape</a>.</p>
<h2 id="context-agnostic">context-agnostic</h2>
<p>Tests run in same context as your application. No special executables needed.</p>
<h2 id="tap-output">TAP Output</h2>
<p>Tester outputs to the console using a partial implementation of the <a href="https://testanything.org/tap-specification.html">Test Anything Protocol</a>.</p>
<h2 id="usage">Usage</h2>
<p>The default export of ./index.mjs is an asynchronous function, <em>tester</em>, that takes a test in the form of an asynchronous iterator.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tester <span class="im">from</span> <span class="st">&quot;./index.mjs&quot;</span><span class="op">;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> <span class="fu">tester</span>(<span class="kw">async</span> <span class="kw">function</span><span class="op">*</span> () {</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* define test here s*/</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
<h3 id="title">Title</h3>
<p>Optionally <em>tester</em> takes a string as it’s first argument. This will be printed out before each test.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tester <span class="im">from</span> <span class="st">&quot;./index.mjs&quot;</span><span class="op">;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> <span class="fu">tester</span>(<span class="st">&quot;test title&quot;</span><span class="op">,</span> <span class="kw">async</span> <span class="kw">function</span><span class="op">*</span> () {</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* define test here s*/</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
<h3 id="definition-and-format">Definition and format</h3>
<p>When creating a test, simply yield the result of an assertion.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tester <span class="im">from</span> <span class="st">&quot;./index.mjs&quot;</span><span class="op">;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ok <span class="im">from</span> <span class="st">&quot;./assertions/ok.mjs&quot;</span><span class="op">;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> <span class="fu">tester</span>(<span class="st">&quot;test title&quot;</span><span class="op">,</span> <span class="kw">async</span> <span class="kw">function</span><span class="op">*</span> () {</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">yield</span> <span class="fu">ok</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
<p>There are 7 built in assertions included alongside the default export for convinience.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tester<span class="op">,</span> {</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  ok<span class="op">,</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  notok<span class="op">,</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  equal<span class="op">,</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  notequal<span class="op">,</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  deepequal<span class="op">,</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  pass<span class="op">,</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  fail<span class="op">,</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>} <span class="im">from</span> <span class="st">&quot;./index.mjs&quot;</span><span class="op">;</span></span></code></pre></div>
<h3 id="with-plan-argument">with plan argument</h3>
<p>The first argument to the test is a <em>plan</em> function which is used to announce then number of tests before they take place via TAP.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tester <span class="im">from</span> <span class="st">&quot;./index.mjs&quot;</span><span class="op">;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ok <span class="im">from</span> <span class="st">&quot;./assertions/ok.mjs&quot;</span><span class="op">;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> <span class="fu">tester</span>(<span class="st">&quot;test title&quot;</span><span class="op">,</span> <span class="kw">async</span> <span class="kw">function</span><span class="op">*</span> (plan) {</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plan</span>(<span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">yield</span> <span class="fu">ok</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
<h2 id="assetions">assetions</h2>
<p>Assertions are functions. They take any number of arguments and return either a success message string or an instance of TestError (“/testerror.mjs”).</p>
<h3 id="included-assertions-1">included assertions</h3>
<h4 id="ok">ok</h4>
<div class="sourceCode" id="cb11"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { ok } <span class="im">from</span> <span class="st">&quot;/index.mjs&quot;</span><span class="op">;</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> result <span class="op">=</span> <span class="fu">ok</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (result <span class="kw">instanceof</span> <span class="bu">Error</span>) {</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">throw</span> result<span class="op">;</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h4 id="notok">notok</h4>
<div class="sourceCode" id="cb12"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { notok } <span class="im">from</span> <span class="st">&quot;/index.mjs&quot;</span><span class="op">;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> result <span class="op">=</span> <span class="fu">notok</span>(<span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (result <span class="kw">instanceof</span> <span class="bu">Error</span>) {</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">throw</span> result<span class="op">;</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h4 id="equal">equal</h4>
<div class="sourceCode" id="cb13"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { equal } <span class="im">from</span> <span class="st">&quot;/index.mjs&quot;</span><span class="op">;</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> result <span class="op">=</span> <span class="fu">equal</span>(<span class="kw">true</span><span class="op">,</span> <span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (result <span class="kw">instanceof</span> <span class="bu">Error</span>) {</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">throw</span> result<span class="op">;</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h4 id="notequal">notequal</h4>
<div class="sourceCode" id="cb14"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { notequal } <span class="im">from</span> <span class="st">&quot;./index.mjs&quot;</span><span class="op">;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> result <span class="op">=</span> <span class="fu">notequal</span>(<span class="kw">true</span><span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (result <span class="kw">instanceof</span> <span class="bu">Error</span>) {</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">throw</span> result<span class="op">;</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h4 id="deepequal">deepequal</h4>
<div class="sourceCode" id="cb15"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { deepequal } <span class="im">from</span> <span class="st">&quot;./index.mjs&quot;</span><span class="op">;</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> result <span class="op">=</span> <span class="fu">deepequal</span>({ <span class="dt">a</span><span class="op">:</span> <span class="kw">true</span> }<span class="op">,</span> { <span class="dt">a</span><span class="op">:</span> <span class="kw">true</span> })<span class="op">;</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (result <span class="kw">instanceof</span> <span class="bu">Error</span>) {</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">throw</span> result<span class="op">;</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h4 id="pass">pass</h4>
<div class="sourceCode" id="cb16"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { pass } <span class="im">from</span> <span class="st">&quot;./index.mjs&quot;</span><span class="op">;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> result <span class="op">=</span> <span class="fu">pass</span>()<span class="op">;</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (result <span class="kw">instanceof</span> <span class="bu">Error</span>) {</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">throw</span> result<span class="op">;</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h4 id="fail">fail</h4>
<div class="sourceCode" id="cb17"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { fail } <span class="im">from</span> <span class="st">&quot;./index.mjs&quot;</span><span class="op">;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> result <span class="op">=</span> <span class="fu">fail</span>()<span class="op">;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (result <span class="kw">instanceof</span> <span class="bu">Error</span>) {</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">throw</span> result<span class="op">;</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h4 id="subtestpass">subtestpass</h4>
<div class="sourceCode" id="cb18"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { subtestpass<span class="op">,</span> pass } <span class="im">from</span> <span class="st">&quot;./index.mjs&quot;</span><span class="op">;</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> result <span class="op">=</span> <span class="cf">await</span> <span class="fu">subtestpass</span>(<span class="kw">function</span><span class="op">*</span> () {</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">yield</span> <span class="fu">pass</span>()<span class="op">;</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (result <span class="kw">instanceof</span> <span class="bu">Error</span>) {</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">throw</span> result<span class="op">;</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h4 id="subtestfail">subtestfail</h4>
<div class="sourceCode" id="cb19"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { subtestfail<span class="op">,</span> fail } <span class="im">from</span> <span class="st">&quot;./index.mjs&quot;</span><span class="op">;</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> result <span class="op">=</span> <span class="cf">await</span> <span class="fu">subtestfail</span>(<span class="kw">function</span><span class="op">*</span> () {</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">yield</span> <span class="fu">fail</span>()<span class="op">;</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (result <span class="kw">instanceof</span> <span class="bu">Error</span>) {</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">throw</span> result<span class="op">;</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h3 id="creating-external-assertions">creating external assertions</h3>
<p>Assertions have the following general form:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">export</span> <span class="im">default</span> (<span class="op">...</span>args) <span class="kw">=&gt;</span> {</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="co">/*test of args passes*/</span>){</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// return a string to indicate success.</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// return instance of TestError</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h2 id="taprunner-print-run">TAPRunner, print, run</h2>
<p>The file “/TAPRunner.mjs” export methods “print” and “run”. “print” functions similarly to the default export of “index.mjs” – both of which rely on “run” to execute underlying code.</p>
<p>When called with as single argument (a test), “run” yields only the results of the test (string or Error) without additional processing.</p>
