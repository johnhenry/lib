<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
      @import "https://johnhenry.github.io/std/js/negatablestring@0.0.0/negative-class.css";
    </style>
    <script></script>
  </head>
  <body>
    <pre>
      <h1>Linear Combinations</h1>
      <script type="module" style="display: block">
        import textToNodes from "https://johnhenry.github.io/std/js/text-to-nodes@0.0.0/index.mjs";
        import "https://johnhenry.github.io/std/js/negatablestring@0.0.0/string-prototype-warn.mjs";
        import { negater, scale, concat } from "https://johnhenry.github.io/std/js/negatablestring@0.0.0/index.mjs";
        const negativeMarkup = ['<span class="negative">', "</span>"];
        const { log } = console;
        const NEGATIVE_COLOR = "red";
        const POSITIVE_COLOR = "lightblue";
        const LinearCombinations = ({ str0, str1, factor0, factor1 }) => {
          const f = negater(str0);
          const s = negater(str1);
          const fscaled = scale(f, factor0);
          const sscaled = scale(s, factor1);
          const result = concat(fscaled, sscaled);
          log(result.toString("~"));
          log(...result.consoleIterator(NEGATIVE_COLOR, POSITIVE_COLOR));
          window.document.getElementById("linear-combinations").append(...textToNodes(`
            <hr />
            "${(f.toString(...negativeMarkup))}" × ${factor0} +
            "${(s.toString(...negativeMarkup))}" × ${factor1}
            <hr />
            "${(fscaled.toString(...negativeMarkup))}" +
            "${(sscaled.toString(...negativeMarkup))}"
            <hr />
            "${(result.toString(...negativeMarkup))}"`));
        };
        const str ="Hello World!";
        LinearCombinations( {
          str0: str,
          factor0: 2,
          str1: scale(str, -1).toString("~"),
          factor1: 2,
        });
      </script>
      <div id="linear-combinations"></div>
    </pre>

    <pre><h1>Permutations</h1>
      <script type="module" style="display: block">
        import { query } from "https://johnhenry.github.io/std/js/url-params@0.0.0/index.mjs.js";
        import textToNodes from "https://johnhenry.github.io/std/js/text-to-nodes@0.0.0/index.mjs";
        import pause from "https://johnhenry.github.io/std/js/pause@0.0.0/index.mjs";
        import transduce from "https://johnhenry.github.io/std/js/iterator-transduce@0.0.0/index.mjs";
        import { map, group } from "https://johnhenry.github.io/std/js/iterator-transduce@0.0.0/transducers.mjs";
        import "https://johnhenry.github.io/std/js/negatablestring@0.0.0/string-prototype-warn.mjs";
        import { negater } from "https://johnhenry.github.io/std/js/negatablestring@0.0.0/index.mjs";
        const negativeMarkup = ['<span class="negative">', "</span>"];
        const numToBinaryArray = (num, len, t = "~", f = "") => {
          return num
            .toString(2)
            .padStart(len, 0)
            .split("")
            .map(Number)
            .map((x) => (x ? t : f));
        };
        const zip = (a0, a1) => {
          return a0.map((item, i) => item + a1[i]);
        };
        const intersperse = function* (word, char = "~", after = false, before = true) {
          const letters = word.split("");
          if (after) {
            letters.push("");
          }
          let x = 0;
          if (!before) {
            x = 2 ** (letters.length - 1);
          }
          for (let i = 0; i < 2 ** letters.length - x; i++) {
            yield zip(numToBinaryArray(i, letters.length, char), letters).join("");
          }
        };
        const transform = transduce(
          map((x) => {
            const li = window.document.createElement("li");
            li.append(...textToNodes(negater(x).toString(...negativeMarkup)));
            return li;
          }),
          group(8)
        );
        const ol = window.document.getElementById("permutations");
        const Permutations = async (string) => {
          for(const x of transform(intersperse(string, "~"))){
            ol.append(...x);
            window.scrollTo(0, window.document.body.scrollHeight);
            await pause(0);
          }
        };
        Permutations(window.query.word||"");
      </script>
      <form>
        <input type="text" name="word" placeholder="Permutations" value="mississippi" />
        <input type="submit" value="Submit" />
      </form>
      <ol id="permutations"></ol>
    </pre>
  </body>
</html>
